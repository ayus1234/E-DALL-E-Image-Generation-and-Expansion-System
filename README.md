# E-DALL-E: Image Generation with Varying Aspect Ratios

This project combines DALL-E Mini for text-to-image generation with a novel expansion technique (E-DALL-E) that allows creating images with different aspect ratios.

## Overview

The system consists of these components:
1. **DALL-E Mini** - Generates square (1:1) images from text prompts
2. **E-DALL-E** - Expands the generated images to different aspect ratios (e.g., 16:9) using VQGAN+CLIP
3. **Image Expander (Download)** - A tool to download and expand online images to different aspect ratios
4. **Image Expander (Local)** - A tool to expand local image files to different aspect ratios
5. **Results Viewer** - A gallery tool to view all expanded images created with the system

## Installation

Install the required dependencies:

```bash
pip install -r requirements.txt
```

## Usage

Run the script with a text prompt:

```bash
python edalle.py --prompt "a painting of rolling farmland" --aspect_ratio 1.78 --num_images 4
```

### Command Line Arguments

- `--prompt`: Text prompt for image generation (default: "a painting of rolling farmland")
- `--num_images`: Number of images to generate (default: 4)
- `--aspect_ratio`: Target aspect ratio for expansion (width/height, default: 16/9)
- `--iterations`: Number of optimization iterations for expansion (default: 100)
- `--model_type`: DALL-E model size ("mini", "mega", or "mega-full", default: "mega")

## How It Works

1. The system first generates square (1:1) images using DALL-E Mini based on your text prompt
2. It then expands one of these images to your desired aspect ratio in two steps:
   - Initially filling in the sides with repeated edge pixels
   - Using VQGAN+CLIP to generate new content on the sides that matches the style and content of the original image and follows the text prompt

## Output

The script generates two output files:
- `dalle_output.png`: The original square images generated by DALL-E Mini
- `expanded_output.png`: A comparison showing the original image, the image with repeated edge pixels, and the final expanded image

## Image Expansion Tools

### Online Image Expansion

The project includes a tool (`download_expand.py`) that allows you to download and expand any online image to your desired aspect ratio.

#### Usage

```bash
python download_expand.py --url "https://example.com/image.jpg" --aspect 16:9 --orientation landscape --output expanded.png
```

#### Command Line Arguments

- `--url`: URL of the image to download (defaults to a sample Van Gogh image)
- `--aspect`: Target aspect ratio, can be in format "16:9" or decimal "1.78" (default: "16:9")
- `--orientation`: Orientation of the expansion, "landscape" or "portrait" (default: "landscape")
- `--output`: Path to save the expanded image (default: "expanded_download.png")

### Local Image Expansion

For local image files, use the `local_expand.py` script:

#### Usage

```bash
python local_expand.py input_image.jpg --aspect 21:9 --orientation landscape --output expanded.png
```

#### Command Line Arguments

- First argument: Path to the input image file (required)
- `--aspect`: Target aspect ratio, can be in format "16:9" or decimal "1.78" (default: "16:9")
- `--orientation`: Orientation of the expansion, "landscape" or "portrait" (default: "landscape")
- `--output`: Path to save the expanded image (default: "expanded_" + input filename)

Both tools save comparison images showing the original and expanded versions side by side.

## Results Viewer

The project also includes a results viewer (`view_results.py`) that creates visual galleries of all expanded images.

### Usage

```bash
python view_results.py
```

This script will:
1. Scan the current directory for expanded and comparison images
2. Generate two gallery images:
   - `comparison_gallery.png`: Shows side-by-side comparisons of original and expanded images
   - `expanded_gallery.png`: Shows all expanded images with their dimensions and aspect ratios

Run this after creating multiple expanded images to see your results in one place.

## Acknowledgments

This implementation is based on:
- [DALL-E Mini](https://github.com/borisdayma/dalle-mini) by Boris Dayma and Pedro Cuenca
- [VQGAN+CLIP](https://github.com/patil-suraj/vqgan-jax) for image expansion
- The original E-DALL-E concept by Robert A. Gonsalves 